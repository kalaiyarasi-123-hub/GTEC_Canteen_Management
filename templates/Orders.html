<!DOCTYPE html>
<html>
<head>
<title>Daily Orders</title>
<style>
body{font-family:Arial;background:#f4f4f4;padding:20px}
.date-box{background:#007bff;color:#fff;padding:10px;border-radius:8px;margin-top:20px;}
.order{background:#fff;padding:12px;border-radius:10px;margin-top:10px}
.items{margin-left:15px;font-size:14px}
.no-orders{margin-top:10px;color:#555}
</style>
</head>

<body>
<h2>Daily Orders</h2>
<div id="orders"></div>

<script>

let lastOrderCount = 0;

// Simple notification sound (beep)
function playSound() {
    let audio = new Audio("https://www.soundjay.com/buttons/sounds/button-3.mp3");
    audio.play();
}

function renderOrders() {

    fetch("/get_orders")
    .then(res => res.json())
    .then(orders => {

        const div = document.getElementById("orders"); 
        div.innerHTML = "";

        // ðŸ”¥ CHECK FOR NEW ORDER
        if(lastOrderCount !== 0 && orders.length > lastOrderCount){
            playSound();
            alert("ðŸ”” New Order Received!");
        }

        lastOrderCount = orders.length;

        if(orders.length === 0){
            div.innerHTML += `<div class="no-orders">No orders yet</div>`;
            return;
        }

        orders.forEach(o => {

            let itemsHTML = "";

            (o.items || []).forEach(i => {
                itemsHTML += `<li>${i.name} x ${i.quantity}</li>`;
            });

            div.innerHTML += `
            <div class="order">
                <b>Order ID:</b> ${o.orderId}<br>
                <b>Date:</b> ${o.date}<br>
                <b>Total:</b> Rs ${o.total}<br>
                <b>Status:</b> ${o.status}
                <ul class="items">${itemsHTML}</ul>
            </div>`;
        });

    });
}

renderOrders();
setInterval(renderOrders, 3000);

</script>

</body>
</html>
